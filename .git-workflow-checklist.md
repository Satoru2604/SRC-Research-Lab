# Git Workflow Checklist - MANDATORY FOR ALL CHANGES

**⚠️ CRITICAL: Read this file BEFORE making ANY changes to the repository**

This checklist ensures compliance with `docs/engineeringculture.md` branching strategy.

---

## Pre-Work Checklist (DO THIS FIRST!)

### Step 1: Verify Current Branch
```bash
git branch --show-current
```

**Expected**: Should be on `master` or `main` (clean state)

**If not**: Complete current work or stash changes first

---

### Step 2: Create Feature Branch (REQUIRED!)

**NEVER work directly on `master`/`main`!**

```bash
# Choose the appropriate branch type:
git checkout -b feature/<description>    # New features
git checkout -b fix/<description>        # Bug fixes
git checkout -b docs/<description>       # Documentation
git checkout -b refactor/<description>   # Code refactoring
git checkout -b test/<description>       # Test additions
git checkout -b experiment/<description> # Research experiments
git checkout -b chore/<description>      # Maintenance
```

**Example for Phase H.4**:
```bash
git checkout -b feature/adaptive-leaderboard-phase-h4
```

---

### Step 3: Verify You're on the Feature Branch
```bash
git branch --show-current
```

**Expected**: Should show `feature/your-branch-name` (NOT `master`)

**If still on master**: STOP! Go back to Step 2

---

## During Work

### ✓ Make Changes
- Edit files
- Create new files in correct directories (see `docs/engineeringculture.md`)

### ✓ Commit Frequently
Use conventional commit format:
```bash
git add <files>
git commit -m "feat(scope): description"
```

**Commit types**: `feat`, `fix`, `docs`, `refactor`, `test`, `chore`

**Examples**:
```bash
git commit -m "feat(leaderboard): add adaptive integration script"
git commit -m "test(integration): add unit tests for adaptive results"
git commit -m "docs(release): add Phase H.4 release notes"
```

### ✓ Test Before Committing
```bash
# Run all tests
pytest -q

# Run specific validation
python scripts/your_script.py

# Check for errors
python -m py_compile scripts/*.py
```

---

## Pre-Push Checklist

Before pushing your branch:

- [ ] All files are in correct directories (scripts/, tests/, docs/, etc.)
- [ ] Root directory is clean (only README.md, LICENSE.md, .gitignore, etc.)
- [ ] All tests pass (`pytest -q`)
- [ ] Documentation is updated
- [ ] Commit messages follow convention (`type(scope): subject`)
- [ ] You are NOT on `master` branch (`git branch --show-current`)

---

## Push and Pull Request

### Step 4: Push Feature Branch
```bash
git push -u origin feature/your-branch-name
```

**DO NOT** push to `master`!

### Step 5: Create Pull Request

On GitHub:
1. Go to repository
2. Click "Pull requests" → "New pull request"
3. Select your branch
4. Fill in PR template:

```markdown
## Summary
- Brief description of changes
- Key features added
- Tests written

## Test Plan
- [ ] All unit tests pass
- [ ] Manual testing completed
- [ ] Documentation updated

## Related Issues
Closes #<issue-number> (if applicable)
```

### Step 6: Wait for Review
- Address feedback promptly
- Make additional commits if needed
- Re-test after changes

### Step 7: Merge
- Use "Squash and merge" for clean history
- Delete branch after merge

---

## Emergency: Already Worked on Master?

If you accidentally made commits on `master`:

### Option 1: Move Commits to New Branch
```bash
# Create feature branch from current master
git branch feature/your-branch-name

# Reset master to origin/master (CAREFUL!)
git checkout master
git reset --hard origin/master

# Switch to feature branch (your work is safe here)
git checkout feature/your-branch-name

# Push feature branch
git push -u origin feature/your-branch-name
```

### Option 2: Create Retrospective Branch
```bash
# If already pushed to master, create branch from specific commit
git checkout -b feature/retrospective-phase-h4 <commit-hash>
git push -u origin feature/retrospective-phase-h4
# Create PR to document the change
```

---

## Quick Reference Card

**✓ DO**:
- Create feature branch BEFORE making changes
- Use conventional commit messages
- Test before committing
- Create pull requests for review
- Keep root directory clean

**✗ DON'T**:
- Work directly on `master`/`main`
- Commit without testing
- Push untested code
- Skip documentation updates
- Ignore branch naming conventions

---

## Verification Commands

### Before Starting Work
```bash
# Am I on the right branch?
git branch --show-current  # Should NOT be "master" or "main"
```

### Before Committing
```bash
# What changes am I committing?
git status
git diff --staged

# Are tests passing?
pytest -q
```

### Before Pushing
```bash
# Am I pushing to the right branch?
git branch --show-current  # Should NOT be "master" or "main"

# What commits am I pushing?
git log origin/master..HEAD --oneline
```

---

## Fatal Mistakes to Avoid

### ❌ FATAL MISTAKE #1: Working on Master
```bash
# WRONG!
git checkout master
# ... make changes ...
git commit -m "changes"
```

### ✅ CORRECT WAY
```bash
# RIGHT!
git checkout -b feature/my-feature
# ... make changes ...
git commit -m "feat(scope): changes"
```

### ❌ FATAL MISTAKE #2: Pushing to Master Directly
```bash
# WRONG!
git push origin master
```

### ✅ CORRECT WAY
```bash
# RIGHT!
git push -u origin feature/my-feature
# Then create PR
```

---

## Integration with AI Assistants

### For Claude/AI Agents

When you (AI assistant) are about to make changes:

1. **ALWAYS** check current branch first:
   ```bash
   git branch --show-current
   ```

2. **IF on `master`**: Create feature branch immediately:
   ```bash
   git checkout -b feature/<descriptive-name>
   ```

3. **Before ANY commit**: Verify you're NOT on master:
   ```bash
   git branch --show-current
   ```

4. **Never suggest** committing directly to master

5. **Always suggest** creating a PR after pushing feature branch

### AI Assistant Pre-Flight Checklist

Before making ANY changes:
- [ ] Check current branch (`git branch --show-current`)
- [ ] Create feature branch if needed
- [ ] Verify NOT on master before each commit
- [ ] Suggest PR creation after work complete

---

## References

- Full guidelines: `docs/engineeringculture.md`
- Branch naming: `docs/engineeringculture.md#branch-naming-conventions`
- Commit format: `docs/engineeringculture.md#commit-message-guidelines`
- PR process: `docs/engineeringculture.md#pull-request-process`

---

## Questions?

If uncertain about workflow:
1. Check `docs/engineeringculture.md`
2. Look at closed PRs for examples
3. Ask for clarification BEFORE committing to master

---

**Last Updated**: 2025-10-16
**Version**: 1.0
**Purpose**: Prevent direct commits to master branch

**⚠️ READ THIS FILE EVERY TIME BEFORE STARTING WORK ⚠️**
